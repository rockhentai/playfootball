var Model={};Model.VER="1.0.0",Model.Event={MTL_LOADED:"mtlLoaded",OBJ_LOADED:"objLoaded",MODEL_LOADED:"modelLoaded"},Model.main=function(e){function u(){var e=new THREE.MTLLoader;e.setPath(n),e.load("main.mtl",f,l,c)}function a(e){var t=new THREE.OBJLoader;e&&t.setMaterials(e),t.setPath(n),t.load("main.obj",h,p,d)}function f(e){e.preload(),a(e),t.dispatchEvent({type:Model.Event.MTL_LOADED})}function l(e){if(!loading)return;var n=t.getObjectByName("tips");n&&t.remove(n);var r=Math.floor(e.loaded/e.total*1e3)/10,i="\u6750\u8d28\u8f7d\u5165\u4e2d\u2026\u2026"+r+"%";n=t.getTextSprite(i),n.name="tips",t.add(n)}function c(e){console.log(e)}function h(e){var n=t.getObjectByName("tips");n&&t.remove(n),t.add(e),t.dispatchEvent({type:Model.Event.OBJ_LOADED}),t.dispatchEvent({type:Model.Event.MODEL_LOADED,obj:e})}function p(e){if(!loading)return;var n=t.getObjectByName("tips");n&&t.remove(n);var r=Math.floor(e.loaded/e.total*1e3)/10,i="\u6a21\u578b\u8f7d\u5165\u4e2d\u2026\u2026"+r+"%";n=t.getTextSprite(i),n.name="tips",t.add(n)}function d(e){console.log(e)}var t=this,n=null,r=12,i="Georgia",s=15,o=20;t.init=function(e){THREE.Object3D.call(t),e&&t.load(e)},t.load=function(e){n=e,u()},t.getTextSprite=function(e){var t=document.createElement("canvas");t.width=r*(e.length+1),t.height=r*3/2;var n=t.getContext("2d");n.fillStyle="#ffffff",n.fillRect(0,0,t.width,t.height),n.font=r+"px "+i,n.fillStyle="#000000",n.fillText(e,r*.5,r);var o=t.toDataURL("image/png",1),u=new Image;u.src=o;var a=new THREE.Texture(u);a.needsUpdate=!0;var f=new THREE.SpriteMaterial({map:a,color:16777215,fog:!0}),l=new THREE.Sprite(f);return l.scale.x=t.width,l.scale.y=t.height,l.position.y=s,l},t.init(e)},Model.main.prototype=Object.create(THREE.Object3D.prototype),Model.main.prototype.constructor=Model.main;
THREE.MTLLoader=function(e){this.manager=e!==undefined?e:THREE.DefaultLoadingManager},THREE.MTLLoader.prototype={constructor:THREE.MTLLoader,load:function(e,t,n,r){var i=this,s=new THREE.FileLoader(this.manager);s.setPath(this.path),s.load(e,function(e){t(i.parse(e))},n,r)},setPath:function(e){this.path=e},setTexturePath:function(e){this.texturePath=e},setBaseUrl:function(e){console.warn("THREE.MTLLoader: .setBaseUrl() is deprecated. Use .setTexturePath( path ) for texture path or .setPath( path ) for general base path instead."),this.setTexturePath(e)},setCrossOrigin:function(e){this.crossOrigin=e},setMaterialOptions:function(e){this.materialOptions=e},parse:function(e){var t=e.split("\n"),n={},r=/\s+/,i={};for(var s=0;s<t.length;s++){var o=t[s];o=o.trim();if(o.length===0||o.charAt(0)==="#")continue;var u=o.indexOf(" "),a=u>=0?o.substring(0,u):o;a=a.toLowerCase();var f=u>=0?o.substring(u+1):"";f=f.trim();if(a==="newmtl")n={name:f},i[f]=n;else if(n)if(a==="ka"||a==="kd"||a==="ks"){var l=f.split(r,3);n[a]=[parseFloat(l[0]),parseFloat(l[1]),parseFloat(l[2])]}else n[a]=f}var c=new THREE.MTLLoader.MaterialCreator(this.texturePath||this.path,this.materialOptions);return c.setCrossOrigin(this.crossOrigin),c.setManager(this.manager),c.setMaterials(i),c}},THREE.MTLLoader.MaterialCreator=function(e,t){this.baseUrl=e||"",this.options=t,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.side=this.options&&this.options.side?this.options.side:THREE.FrontSide,this.wrap=this.options&&this.options.wrap?this.options.wrap:THREE.RepeatWrapping},THREE.MTLLoader.MaterialCreator.prototype={constructor:THREE.MTLLoader.MaterialCreator,setCrossOrigin:function(e){this.crossOrigin=e},setManager:function(e){this.manager=e},setMaterials:function(e){this.materialsInfo=this.convert(e),this.materials={},this.materialsArray=[],this.nameLookup={}},convert:function(e){if(!this.options)return e;var t={};for(var n in e){var r=e[n],i={};t[n]=i;for(var s in r){var o=!0,u=r[s],a=s.toLowerCase();switch(a){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(u=[u[0]/255,u[1]/255,u[2]/255]),this.options&&this.options.ignoreZeroRGBs&&u[0]===0&&u[1]===0&&u[2]===0&&(o=!1);break;default:}o&&(i[a]=u)}}return t},preload:function(){for(var e in this.materialsInfo)this.create(e)},getIndex:function(e){return this.nameLookup[e]},getAsArray:function(){var e=0;for(var t in this.materialsInfo)this.materialsArray[e]=this.create(t),this.nameLookup[t]=e,e++;return this.materialsArray},create:function(e){return this.materials[e]===undefined&&this.createMaterial_(e),this.materials[e]},createMaterial_:function(e){function i(e,t){return typeof t!="string"||t===""?"":/^https?:\/\//i.test(t)?t:e+t}function s(e,n){if(r[e])return;var s=t.getTextureParams(n,r),o=t.loadTexture(i(t.baseUrl,s.url));o.repeat.copy(s.scale),o.offset.copy(s.offset),o.wrapS=t.wrap,o.wrapT=t.wrap,r[e]=o}var t=this,n=this.materialsInfo[e],r={name:e,side:this.side};for(var o in n){var u=n[o];if(u==="")continue;switch(o.toLowerCase()){case"kd":r.color=(new THREE.Color).fromArray(u);break;case"ks":r.specular=(new THREE.Color).fromArray(u);break;case"map_kd":s("map",u);break;case"map_ks":s("specularMap",u);break;case"map_bump":case"bump":s("bumpMap",u);break;case"ns":r.shininess=parseFloat(u);break;case"d":u<1&&(r.opacity=u,r.transparent=!0);break;case"Tr":u>0&&(r.opacity=1-u,r.transparent=!0);break;default:}}return this.materials[e]=new THREE.MeshPhongMaterial(r),this.materials[e]},getTextureParams:function(e,t){var n={scale:new THREE.Vector2(1,1),offset:new THREE.Vector2(0,0)},r=e.split(/\s+/),i;return i=r.indexOf("-bm"),i>=0&&(t.bumpScale=parseFloat(r[i+1]),r.splice(i,2)),i=r.indexOf("-s"),i>=0&&(n.scale.set(parseFloat(r[i+1]),parseFloat(r[i+2])),r.splice(i,4)),i=r.indexOf("-o"),i>=0&&(n.offset.set(parseFloat(r[i+1]),parseFloat(r[i+2])),r.splice(i,4)),n.url=r.join(" ").trim(),n},loadTexture:function(e,t,n,r,i){var s,o=THREE.Loader.Handlers.get(e),u=this.manager!==undefined?this.manager:THREE.DefaultLoadingManager;return o===null&&(o=new THREE.TextureLoader(u)),o.setCrossOrigin&&o.setCrossOrigin(this.crossOrigin),s=o.load(e,n,r,i),t!==undefined&&(s.mapping=t),s}};